我们将从头开始使用**线性回归**模型来建立**Y染色体浓度**与 **孕周数** 、**BMI**等特征之间的关系。以下是一步一步的指导：

### **步骤 1：导入所需的库和数据**

我们将首先导入所需的Python库，并读取合并后的数据（特征矩阵和目标变量）。

```python
# 导入必要的库
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

# 读取数据
X = pd.read_csv('/mnt/data/X_features.csv')  # 特征数据
y = pd.read_csv('/mnt/data/y_target.csv')    # 目标变量数据

# 合并特征数据和目标变量数据
data = pd.concat([X, y], axis=1)

# 查看合并后的数据
print(data.head())
```

### **步骤 2：数据分割**

我们将数据分割为**训练集**和 **测试集** ，通常按照 80% 训练和 20% 测试的比例进行分割。

```python
# 选择自变量和因变量
X = data[['孕妇的孕周', 'BMI']]  # 自变量
y = data['Y染色体浓度']  # 因变量

# 数据拆分：80%训练数据，20%测试数据
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 检查数据分割的结果
print(X_train.shape, X_test.shape)
```

### **步骤 3：训练线性回归模型**

我们将使用**sklearn**中的 `LinearRegression`模型来拟合训练数据。

```python
# 创建线性回归模型
lr_model = LinearRegression()

# 训练模型
lr_model.fit(X_train, y_train)

# 输出回归系数
print("回归系数:", lr_model.coef_)
print("截距项:", lr_model.intercept_)
```

### **步骤 4：预测与评估**

使用训练好的模型进行预测，并计算评估指标。

```python
# 使用测试集进行预测
y_pred = lr_model.predict(X_test)

# 计算评估指标
mse = mean_squared_error(y_test, y_pred)  # 均方误差
rmse = mean_squared_error(y_test, y_pred, squared=False)  # 均方根误差
mae = mean_absolute_error(y_test, y_pred)  # 平均绝对误差
r2 = r2_score(y_test, y_pred)  # R²值

# 输出评估结果
print(f'MSE: {mse:.4f}')
print(f'RMSE: {rmse:.4f}')
print(f'MAE: {mae:.4f}')
print(f'R²: {r2:.4f}')
```

### **步骤 5：结果分析**

1. **回归系数** ：这将告诉我们**孕周数**和**BMI**对**Y染色体浓度**的影响程度。例如，如果某个系数非常大，说明相应的特征对预测影响很大。
2. **评估指标** ：

* **MSE** （均方误差）和 **RMSE** （均方根误差）：衡量预测值与实际值之间的误差，误差越小，模型表现越好。
* **MAE** （平均绝对误差）：衡量每个预测值和真实值之间的平均差异。
* **R²值** ：衡量模型的拟合度，越接近1表示模型越能解释数据中的变异性。

### **总结**

通过以上步骤，你将使用**线性回归**模型来分析**Y染色体浓度**与 **孕妇的孕周数** 、**BMI**之间的关系。你可以根据回归系数的大小解释特征的重要性，使用评估指标来衡量模型的效果。
