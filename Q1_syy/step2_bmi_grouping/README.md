# BMI分组回归分析

## 概述
根据新的BMI分组标准对孕妇数据进行分组，建立独立模型和分段回归模型，分析不同BMI组内孕周数对Y染色体浓度的影响。

## BMI分组标准
- BMI<20: 体重不足
- [20,28): 正常体重
- [28,32): 超重
- [32,36): 肥胖I级
- [36,40): 肥胖II级
- BMI≥40: 肥胖III级

## 数据分布
- 总样本数: 1062
- [28,32)组: 530个样本 (49.9%)
- [32,36)组: 406个样本 (38.2%)
- [36,40)组: 89个样本 (8.4%)
- [20,28)组: 19个样本 (1.8%)
- BMI≥40组: 18个样本 (1.7%)

## 主要发现

### 1. 各BMI组的Y染色体浓度特征
- **[28,32)组**: 平均浓度最高 (0.0825)，变异最大 (std=0.0342)
- **[32,36)组**: 平均浓度较高 (0.0768)，变异较大 (std=0.0311)
- **[36,40)组**: 平均浓度较低 (0.0577)，变异较小 (std=0.0280)
- **[20,28)组**: 平均浓度低 (0.0593)，变异小 (std=0.0238)
- **BMI≥40组**: 平均浓度低 (0.0663)，变异大 (std=0.0493)

### 2. 模型性能比较

#### 独立模型性能 (按R²排序):
1. **BMI≥40组多项式模型**: R²=0.428, RMSE=0.036, MAE=0.027
2. **BMI≥40组线性模型**: R²=0.353, RMSE=0.039, MAE=0.030
3. **[20,28)组多项式模型**: R²=0.324, RMSE=0.019, MAE=0.014
4. **[20,28)组线性模型**: R²=0.128, RMSE=0.022, MAE=0.015
5. **[36,40)组多项式模型**: R²=0.128, RMSE=0.026, MAE=0.021

#### 分段回归模型:
- R²=0.086, RMSE=0.032, MAE=0.026

### 3. 关键发现

1. **BMI≥40组**和**[20,28)组**的模型性能最好，说明这两个极端BMI组内孕周数与Y染色体浓度的关系相对明确。

2. **中等BMI组**([28,32)和[32,36))的模型性能较差，R²均小于0.03，说明这些组内孕周数与Y染色体浓度的线性关系较弱。

3. **分段回归模型**的整体性能(R²=0.086)优于大部分独立模型，说明不同BMI组确实存在不同的回归关系。

4. **BMI组间差异明显**：
   - 高BMI组(BMI≥40)和低BMI组([20,28))的回归关系相对清晰
   - 中等BMI组的回归关系复杂，可能需要更复杂的模型

## 分段回归系数分析

### 截距项（反映各BMI组的基础Y染色体浓度）：
- [28,32)组: 0.0408 (最高)
- [32,36)组: 0.0422 (最高)
- [20,28)组: 0.0058 (较低)
- [36,40)组: -0.0039 (最低)
- BMI≥40组: -0.0848 (最低)

### 斜率项（反映孕周数对Y染色体浓度的影响）：
- BMI≥40组: 0.0069 (影响最大)
- [20,28)组: 0.0019 (影响较大)
- [36,40)组: 0.0022 (影响较大)
- [28,32)组: 0.0013 (影响较小)
- [32,36)组: 0.0009 (影响最小)

## 结论

1. **BMI分组策略有效**：不同BMI组确实表现出不同的孕周数-Y染色体浓度关系。

2. **极端BMI组关系更明确**：BMI≥40和[20,28)组的回归关系相对清晰，模型性能较好。

3. **中等BMI组关系复杂**：[28,32)和[32,36)组的线性关系较弱，可能需要非线性模型或更多特征。

4. **分段回归优于独立模型**：分段回归模型能够捕捉不同BMI组的差异，整体性能更好。

5. **临床意义**：不同BMI组的孕妇在孕周数对Y染色体浓度的影响上存在显著差异，需要分别考虑。

## 文件说明
- `bmi_analysis_simple.py`: 简化版分析脚本（无可视化）
- `bmi_grouping_analysis.py`: 完整版分析脚本（包含可视化）
- `bmi_group_statistics.csv`: 各BMI组统计信息
- `model_comparison_results.csv`: 模型性能比较结果
